else {
mt[nrow(mt) + 1,] <- c(PL[i,1],PL[i,2],'mt',k-21,time,error)
}
}
}
mt$time <- as.numeric(mt$time)
mt$error <- as.numeric(mt$error)
mt$trial <- as.numeric(mt$trial)
# Chunk 16
mt3<-mt%>%ungroup%>%select(PartID,time,trial)
mt4<-mt%>%ungroup%>%select(PartID,error,trial)
mt_t_w<- spread(mt3, trial, time)
mt_e_w<- spread(mt4, trial, error)
mt_t_w<-select(mt_t_w,-PartID)
mt_e_w<-select(mt_e_w,-PartID)
psych::alpha(mt_t_w)
psych::alpha(mt_e_w)
# Chunk 17
# Check # of trials per each subject
data_tmp4check <- aggregate(error ~ PartID * Subgroup, FUN=NROW, data = mt )
unique(data_tmp4check[data_tmp4check$trial != 10,])
#View(data_tmp4check)
length(unique(d$PartID))
data_tmp4check[data_tmp4check$trial !=10,1]
# Outliers
summary(mt)
mt2<-mt #place holder while deciding on outliers
#mt2<-mt2%>%filter(error<95) #3sd above mean
#length(unique(mt$PartID))
length(unique(mt2$PartID))
histogram(mt2$error)
#mt2<-mt2%>%filter(time<73.51465)
histogram(mt2$time)
mt2$Subgroup<-as.factor(mt2$Subgroup)
# Chunk 18
mt_df<-dplyr::summarise(group_by(mt2,PartID,Subgroup),
mean_mt_e=mean(error,na.rm = T),mean_mt_t=mean(time, na.rm=T))
# Chunk 19
mt2$Subgroup<-as.factor(mt2$Subgroup)
mt2 = merge(mt2,d[,c(1,3,4,6)],all.x=TRUE)
#extract trial 1
mt_1<-mt2%>%
dplyr::filter(trial==1)
me_1<-mt2%>%
dplyr::filter(trial==1)
# Chunk 20
mtri1<-lm(error~Age+Sex+kbit_ss+Subgroup,data=me_1)
anova(mtri1)
eta_sq(mtri1)
t.test(error~Subgroup,data=me_1)
mtri2<-lm(time~Age+Sex+kbit_ss+Subgroup,data=mt_1)
anova(mtri2)
#eta_sq(mtri2)
t.test(time~Subgroup,data=mt_1)
cohen.d(mt_1$time,mt_1$Subgroup)
cohen.d(mt_1$error,mt_1$Subgroup)
# Chunk 21
mt1<-mt2
mt2<-mt2%>%filter(trial!=1) #exclude trial 1
#mt2$PartID<-as.factor(mt2$PartID)
mt2_age_gender_iq = merge(mt2,d[,c(1,3,4,6)],all.x=TRUE)
lmerm1<-lmer(time~Age+Sex+kbit_ss+Subgroup*trial+(1+trial|PartID),
data=mt2_age_gender_iq)
lmerm2<-lmer(time~Age+Sex+kbit_ss+Subgroup*trial+(1|PartID),
data=mt2_age_gender_iq)
#lmerm3<-lmer(time~Age+Sex+kbit_ss+Subgroup*trial+(1|trial),
#data=mt2_age_gender_iq)
anova(lmerm1,lmerm2)
#anova(lmerm1,lmerm3)
summary(lmerm1)
anova(lmerm1)
r2beta(lmerm1, method = "nsj")
# Chunk 22
lmerm4<-lmer(error~Age+Sex+kbit_ss+Subgroup*trial+(1+trial|PartID),
data=mt2_age_gender_iq)
lmerm5<-lmer(error~Age+Sex+kbit_ss+Subgroup*trial+(1|PartID),
data=mt2_age_gender_iq)
#lmerm6<-lmer(error~Age+Sex+kbit_ss+Subgroup*trial+(1|trial),
#data=mt2_age_gender_iq)
anova(lmerm4,lmerm5)
#anova(lmerm4,lmerm6)
anova(lmerm4)
r2beta(lmerm4, method = "nsj")
summary(lmerm4)
# Chunk 23
mt2<-mt
mt2<-mt2%>%filter(trial!=1)
mt2$time <- as.numeric(mt2$time)
mt2$error <- as.numeric(mt2$error)
mt2$trial <- as.numeric(mt2$trial)
mtTPlot<-dplyr::summarise(group_by(mt2,Subgroup,trial), n = n(),
meanT=mean(time,na.rm = T), sd=sd(time,na.rm = T),se = sd/sqrt(n))
mtEPlot<-dplyr::summarise(group_by(mt2,Subgroup,trial), n = n(),
meanE=mean(error,na.rm = T), sd=sd(error,na.rm = T),se = sd/sqrt(n))
mt_t<-ggplot(data = mtTPlot, aes(x=trial, y=meanT, color = Subgroup))+
geom_line(size=1.5) +geom_point(size=2)  +
scale_color_manual(values=c('#00BDD0','#E7861B'))+
geom_errorbar(aes(ymin=meanT-se,ymax=meanT+se),
width=.2,  size=0.5)+
scale_x_continuous(breaks=seq(1,16,1))+
#scale_y_continuous(limits = c(0.2, 0.5))+
theme(
axis.title = element_text(family = "Times New Roman", size = 20),
legend.key.size = unit(1, "cm"),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15))  +
labs(x = "Trials", y = "Completion Time (secs)") +
theme(panel.background = element_rect(fill = "white", colour = "grey50"),text=element_text(size=16,family="Times New Roman"),legend.key.size = unit(0.8, "cm"),
legend.text = element_text(
size = 16,
face = 'bold'
),
legend.title = element_blank(),)+
theme(axis.line = element_line(arrow = arrow(angle = 15, length = unit(.15,"inches"),type = "closed")))
mt_t2<-mt_t + theme(legend.position = "none")
#ggsave("mt_t011222.png",width=6, height=4)
# Chunk 24
mt_e<-ggplot(data = mtEPlot, aes(x=trial, y=meanE, color = Subgroup))+
geom_line(size=1.5) +geom_point(size=2)  +
scale_color_manual(values=c('#00BDD0','#E7861B'))+
geom_errorbar(aes(ymin=meanE-se,ymax=meanE+se),
width=.2,  size=0.5)+
scale_x_continuous(breaks=seq(0,10,1))+
#scale_y_continuous(limits = c(0.2, 0.5))+
theme(
axis.title = element_text(family = "Times New Roman", size = 20),
legend.key.size = unit(1, "cm"),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15))  +
labs(x = "Trials", y = "Number of Errors") +
theme(panel.background = element_rect(fill = "white", colour = "grey50"),text=element_text(size=16,family="Times New Roman"),legend.key.size = unit(0.8, "cm"),
legend.text = element_text(
size = 16,
face = 'bold'
),
legend.title = element_blank(),)+
theme(axis.line = element_line(arrow = arrow(angle = 15, length = unit(.15,"inches"),type = "closed")))
mt_e2<-mt_e + theme(legend.position = "none")
#ggsave("mt_e011222.png",width=6, height=4)
# Chunk 25
names(SL)[names(SL) == "subj"] <- "PartID"
d_all<-merge(d,mt_df,all = TRUE)
d_all <-merge(d_all,rp_df,all=TRUE)
d_all <-merge(d_all,SL,all=TRUE)
table(SL$group)
# Chunk 26
subj_table_vsl<-read.csv("sl_analysis/vsl_rt_subj_table.csv")
fam_trial_vsl<-read.csv("sl_analysis/vsl_rt_trial.csv")
fam_trial_vsl_scale<-read.csv("sl_analysis/vsl_rt_scale_trial.csv")
subj_table_tsl<-read.csv("sl_analysis/tsl_rt_subj_table.csv")
fam_trial_tsl<-read.csv("sl_analysis/tsl_rt_trial.csv")
fam_trial_tsl_scale<-read.csv("sl_analysis/tsl_rt_scale_trial.csv")
#need to rename from Subj  to PartID
names(subj_table_vsl)[names(subj_table_vsl)=="subj"] <- "PartID"
names(fam_trial_vsl)[names(fam_trial_vsl)=="subj"] <- "PartID"
names(fam_trial_vsl_scale)[names(fam_trial_vsl_scale)=="subj"] <- "PartID"
names(subj_table_tsl)[names(subj_table_tsl)=="subj"] <- "PartID"
names(fam_trial_tsl)[names(fam_trial_tsl)=="subj"] <- "PartID"
names(fam_trial_tsl_scale)[names(fam_trial_tsl_scale)=="subj"] <- "PartID"
# Chunk 27
data<-as_tibble(subj_table_tsl)
data %>%
group_by(Subgroup) %>%
dplyr::summarise(
count = n(),
rt = qwraps2::mean_sd(mean_rt),
slope = qwraps2::mean_sd(rt_slope),
d_prime = qwraps2::mean_sd(dprime),
hits = qwraps2::mean_sd(hit_rate)
)
# Chunk 28
usable_tsl_rt<-subj_table_tsl[subj_table_tsl$hit_rate>0.25,]$PartID
subj_table_tsl_usable <-subset(subj_table_tsl,PartID %in% usable_tsl_rt)
data<-as_tibble(subj_table_tsl_usable)
data %>%
group_by(Subgroup) %>%
dplyr::summarise(
count = n(),
rt = qwraps2::mean_sd(mean_rt),
slope = qwraps2::mean_sd(rt_slope),
d_prime = qwraps2::mean_sd(dprime),
hits = qwraps2::mean_sd(hit_rate)
)
# Chunk 29
t.test(subj_table_tsl_usable$mean_rt~subj_table_tsl_usable$Subgroup)
# Chunk 30
t.test(hit_rate~Subgroup,data=subj_table_tsl_usable)
# Chunk 31
fam_trial_tsl_usable <-subset(fam_trial_tsl,PartID %in% usable_tsl_rt)
fam_trial_tsl_usable_s <-subset(fam_trial_tsl_scale,PartID %in% usable_tsl_rt)
fam_tsl_age_gender_iq = merge(fam_trial_tsl_usable,d[,c(1,3,4,6)],all.x=TRUE)
fam_tsl_s_age_gender_iq = merge(fam_trial_tsl_usable_s,d[,c(1,3,4,6)],all.x=TRUE)
model2_cov <- lmer(rt_col~Age+Sex+kbit_ss+reindex*Subgroup+(1+reindex|PartID),data=fam_tsl_age_gender_iq)
summary(model2_cov)
r2beta(model2_cov, method = "nsj")
# Chunk 32
subj_table_tsl_gender_iq = merge(subj_table_tsl_usable,d[,c(1,3,4,6)],all.x=TRUE)
tsl_rt_ancova=lm(rt_slope~Subgroup+Age+Sex+kbit_ss,data=subj_table_tsl_gender_iq)
summary(tsl_rt_ancova)
# Chunk 33
tsl_rt_plot<-dplyr::summarise(group_by(fam_trial_tsl,Subgroup,reindex), n = n(),
mean=mean(rt_col,na.rm = T), sd=sd(rt_col,na.rm = T),se = sd/sqrt(n))
tsl_rt<-ggplot(data = tsl_rt_plot, aes(x=reindex, y=mean, col=Subgroup))+
geom_line(size=1.5) +geom_point(size=2)  +
scale_color_manual(values=c('#00BDD0','#E7861B'))+
geom_errorbar(aes(ymin=mean-se,ymax=mean+se),
width=.2,  size=0.5)+
scale_x_continuous(breaks=seq(4,48,4))+
#scale_y_continuous(limits = c(0.2, 0.5))+
theme(
axis.title = element_text(family = "Trebuchet MS", size = 20),
legend.key.size = unit(1, "cm"),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15))  +
labs(x = "Trials", y = "Response Time (ms)") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.line = element_line(arrow = arrow(angle = 15, length = unit(.15,"inches"),type = "closed")))
tsl_rt2<-tsl_rt + theme(legend.position = "none")
#ggsave("tsl_rt011222.png",width=7, height=4)
# Chunk 34
asl_slope<-subj_table_tsl_usable%>%dplyr::select("PartID","Subgroup","rt_slope")
asl_slope<-na.omit(asl_slope)
asl_slope2 = asl_slope %>%
dplyr::group_by(PartID, Subgroup) %>%
dplyr::summarise(mean = mean(rt_slope, na.rm = T))
multi.group_asl <-
asl_slope2 %>%
dabestr::dabest(Subgroup,mean,
idx = list(c("TYP","DD")),
paired = FALSE
)
multi.group_asl_2 <- dabestr::cohens_d(multi.group_asl)
plot(multi.group_asl_2, palette=c("blue","red"),rawplot.ylabel = "ASL Time Slope")
# Chunk 35
data<-as_tibble(subj_table_vsl)
data %>%
group_by(Subgroup) %>%
dplyr::summarise(
count = n(),
rt = qwraps2::mean_sd(mean_rt),
slope = qwraps2::mean_sd(rt_slope),
d_prime = qwraps2::mean_sd(dprime),
hits = qwraps2::mean_sd(hit_rate)
)
# Chunk 36
t.test(subj_table_vsl$mean_rt~subj_table_vsl$Subgroup)
t.test(subj_table_vsl$hit_rate~subj_table_vsl$Subgroup)
# Chunk 37
subj_table_vsl_iq_age = merge(data,d[,c(1,3,4,6)],all.x=TRUE)
summary(lm(dprime~Age+Sex+kbit_ss+Subgroup,data=subj_table_vsl_iq_age))
# Chunk 38
fam_vsl_age_gender_iq = merge(fam_trial_vsl,d[,c(1,3,4,6)],all.x=TRUE)
fam_vsl_s_age_gender_iq = merge(fam_trial_vsl_scale,d[,c(1,3,4,6)],all.x=TRUE)
model2_cov <- lmer(rt_col~Age+Sex+kbit_ss+reindex*Subgroup+(1+reindex|PartID),data=fam_vsl_age_gender_iq)
summary(model2_cov)
r2beta(model2_cov, method = "nsj")
# Chunk 39
subj_table_vsl_gender_iq = merge(subj_table_vsl,d[,c(1,3,4,6)],all.x=TRUE)
vsl_rt_ancova=aov(rt_slope~Subgroup+Age+Sex+kbit_ss,data=subj_table_vsl_gender_iq)
summary(vsl_rt_ancova)
# Chunk 40
model2_DYS <- lmer(rt_col~Age+Sex+kbit_ss+reindex+(1+reindex|PartID),data=fam_vsl_age_gender_iq[fam_vsl_age_gender_iq$Subgroup=="DD",])
summary(model2_DYS)
# Chunk 41
model2_TYP <- lmer(rt_col~Age+Sex+kbit_ss+reindex+(1+reindex|PartID),data=fam_vsl_age_gender_iq[fam_vsl_age_gender_iq$Subgroup=="TYP",])
summary(model2_TYP)
# Chunk 42
vsl_rt_plot<-dplyr::summarise(group_by(fam_trial_vsl,Subgroup,reindex), n = n(),
mean=mean(rt_col,na.rm = T), sd=sd(rt_col,na.rm = T),se = sd/sqrt(n))
vsl_rt<-ggplot(data = vsl_rt_plot, aes(x=reindex, y=mean, color = Subgroup))+
geom_line(size=1.5) +geom_point(size=2)  +
scale_color_manual(values=c('#00BDD0','#E7861B'))+
geom_errorbar(aes(ymin=mean-se,ymax=mean+se),
width=.2,  size=0.5)+
scale_x_continuous(breaks=seq(2,24,2))+
#scale_y_continuous(limits = c(0.2, 0.5))+
theme(
axis.title = element_text(family = "Trebuchet MS", size = 20),
legend.key.size = unit(1, "cm"),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15))  +
labs(x = "Trials", y = "Response Time (ms)") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.line = element_line(arrow = arrow(angle = 15, length = unit(.15,"inches"),type = "closed")))
vsl_rt2<-vsl_rt + theme(legend.position = "none")
ggsave("vsl_rt011222.png",width=7, height=4)
# Chunk 43
vsl_slope<-subj_table_vsl%>%dplyr::select("PartID","Subgroup","rt_slope")
vsl_slope<-na.omit(vsl_slope)
vsl_slope2 = vsl_slope %>%
dplyr::group_by(PartID, Subgroup) %>%
dplyr::summarise(mean = mean(rt_slope, na.rm = T))
multi.group_vsl <-
vsl_slope2 %>%
dabestr::dabest(Subgroup,mean,
idx = list(c("TYP","DD")),
paired = FALSE
)
multi.group_vsl_2 <- dabestr::cohens_d(multi.group_vsl)
plot(multi.group_vsl_2, palette=c("blue","red"),rawplot.ylabel = "VSL Slope")
# Chunk 44
colnames(subj_table_tsl_usable)[1]="subj"
colnames(subj_table_vsl)[1]="subj"
subj_table_tsl_usable$task = "Auditory"
subj_table_vsl$task = "Visual"
all_subj_slope = rbind(subj_table_vsl,subj_table_tsl_usable)
fam_trial_vsl_scale$task="Visual"
fam_trial_tsl_usable_s$task="Auditory"
all_fam_trials = rbind(fam_trial_vsl_scale,fam_trial_tsl_usable_s)
# Chunk 45
all_subj_slope$tasknum=""
for (id in all_subj_slope$subj) {
all_subj_slope[all_subj_slope$subj==id,]$tasknum = nrow(all_subj_slope[all_subj_slope$subj==id,])
}
all_subj_slope_complete = subset(all_subj_slope,tasknum==2)
all_subj_slope_age_gender_iq = merge(all_subj_slope_complete,d[,c(1,3,4,6)],all.x=TRUE)
all_fam_trials_age_gender_iq = merge(all_fam_trials,d[,c(1,3,4,6)],all.x=TRUE)
model_rt_lmer_cov <- lmer(rt_col~Age+Sex+kbit_ss+task*reindex*Subgroup+(1+task|PartID)+(task|reindex),data=all_fam_trials_age_gender_iq)
print(summary(model_rt_lmer_cov))
# Chunk 46
all_sl_slope_ancova = lm(rt_slope_scale~Subgroup*task+Age+Sex+kbit_ss,data=all_subj_slope_age_gender_iq)
print(summary(all_sl_slope_ancova))
# Chunk 47
all_accuracy=read.csv("sl_analysis/all_sl_accuracy.csv")
all_acc_table=read.csv("sl_analysis/sl_acc_subj_table.csv")
vsl_acc_table=subset(all_acc_table,task=="Visual")
tsl_acc_table=subset(all_acc_table,task=="Auditory")
vsl_accuracy=subset(all_accuracy,task=="Visual")
tsl_accuracy=subset(all_accuracy,task=="Auditory")
data<-as_tibble(all_acc_table)
data %>%
group_by(Subgroup,task) %>%
dplyr::summarise(
count = n(),
accuracy = qwraps2::mean_sd(subj_corr)
)
# Chunk 48
DD_acc_vsl = subset(vsl_acc_table,Subgroup=="DD")
TYP_acc_vsl = subset(vsl_acc_table,Subgroup=="TYP")
DD_acc_tsl = subset(tsl_acc_table,Subgroup=="DD")
TYP_acc_tsl = subset(tsl_acc_table,Subgroup=="TYP")
t.test(DD_acc_vsl$subj_corr,mu=0.5,alternative = "greater")
t.test(DD_acc_tsl$subj_corr,mu=0.5,alternative = "greater")
t.test(TYP_acc_vsl$subj_corr,mu=0.5,alternative = "greater")
t.test(TYP_acc_tsl$subj_corr,mu=0.5,alternative = "greater")
# Chunk 49
vsl_accuracy = subset(all_accuracy,task=="Visual")
tsl_accuracy = subset(all_accuracy,task=="Auditory")
vsl_accuracy_age_gender_iq = merge(vsl_accuracy,d[,c(1,3,4,6)],by="PartID",all.x=TRUE)
tsl_accuracy_age_gender_iq = merge(tsl_accuracy,d[,c(1,3,4,6)],by="PartID",all.x=TRUE)
# Chunk 50
model_vslacc_lmer_cov <- glmer(corr~Age+Sex+kbit_ss+Subgroup+(1|PartID)+(1|trial),data=vsl_accuracy_age_gender_iq,family="binomial", control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
print(summary(model_vslacc_lmer_cov))
# Chunk 51
all_acc_table_age_gender_iq = merge(all_acc_table,d[,c(1,3,4,6)],by="PartID",all.x=TRUE)
vsl_acc_table = subset(all_acc_table_age_gender_iq,task == "Visual")
asl_acc_table = subset(all_acc_table_age_gender_iq,task == "Auditory")
#vslacc_ancova <- aov(subj_corr~Age+Sex+IQ+Subgroup,data=vsl_acc_table)
#print(summary(vslacc_ancova))
# Chunk 52
model_tslacc_lmer_cov <- glmer(corr~Age+Sex+kbit_ss+Subgroup+(1|PartID)+(1|trial),data=tsl_accuracy_age_gender_iq,family="binomial",control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
print(summary(model_tslacc_lmer_cov))
# Chunk 53
#aslacc_ancova <- aov(subj_corr~Age+Sex+IQ+Subgroup,data=asl_acc_table)
#print(summary(aslacc_ancova))
# Chunk 54
vsl_acc_summary = vsl_acc_table %>%
dplyr::group_by(PartID, Subgroup) %>%
dplyr::summarise(mean = mean(subj_corr, na.rm = T))
multi.group_vsl_acc <-
vsl_acc_summary %>%
dabestr::dabest(Subgroup,mean,
idx = list(c("TYP","DD")),
paired = FALSE
)
multi.group_vsl_acc_2 <- dabestr::cohens_d(multi.group_vsl_acc)
plot(multi.group_vsl_acc_2, palette=c("blue","red"),rawplot.ylabel = "VSL Accuracy")
# Chunk 55
tsl_acc_summary = tsl_acc_table %>%
dplyr::group_by(PartID, Subgroup) %>%
dplyr::summarise(mean = mean(subj_corr, na.rm = T))
multi.group_tsl_acc <-
tsl_acc_summary %>%
dabestr::dabest(Subgroup,mean,
idx = list(c("TYP","DD")),
paired = FALSE
)
multi.group_tsl_acc_2 <- dabestr::cohens_d(multi.group_tsl_acc)
plot(multi.group_tsl_acc_2, palette=c("blue","red"),rawplot.ylabel = "ASL Accuracy")
# Chunk 56
all_accuracy_age_gender_iq = merge(all_accuracy,d[,c(1,3,4,6)],by="PartID",all.x=TRUE)
model_acc_lmer <- glmer(corr~task*Subgroup+Age+Sex+(1+task|PartID)+(1|trial),data=all_accuracy_age_gender_iq,family="binomial",control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
print(summary(model_acc_lmer))
# Chunk 57
all_acc_table_complete = subset(all_acc_table,PartID="ABCD_1708")
all_acc_table_complete = subset(all_acc_table_complete,PartID!="ABCD_1727")
all_acc_table_age_gender_iq = merge(all_acc_table_complete,d[,c(1,3,4,6)],by="PartID",all.x=TRUE)
model_acc <- lm(subj_corr~task*Subgroup+Age+Sex+kbit_ss,data=all_acc_table_age_gender_iq)
print(summary(model_acc))
# Chunk 58
stat.test <- all_acc_table %>%
group_by(task) %>%
tukey_hsd(subj_corr~Subgroup)
stat.test
stat.test <- stat.test %>% add_xy_position(x = "group", fun = "mean_se")
all_acc_table$Subgroup = as.factor(all_acc_table$Subgroup)
#cbbPalette <- c("#00BDD0","#E7861B")
ggplot() +
geom_bar(aes(x = Subgroup,y = subj_corr,fill = Subgroup),data=all_acc_table,colour = '#000000',fun.data = mean_sdl,fun.args = list(mult = 1),stat = 'summary',position = position_dodge(width = 0.9)) +
scale_fill_manual("legend", values = c("DD" = "#00BDD0", "TYP" = "#E7861B"))+
theme_classic(base_size = 18.0) +
ylab(label = '% Correct') +
xlab(label = 'Group') +
#coord_cartesian(ylim = c(0.3,1)) +
geom_errorbar(aes(y = subj_corr, x = Subgroup),data=all_acc_table,size = 0.3,width = 0.2,fun.y = function(x) mean(x),fun.ymin = function(x) mean(x) - sd(x)/sqrt(length(x)),fun.ymax = function(x) mean(x) + sd(x)/sqrt(length(x)) ,stat = 'summary')+
geom_beeswarm(aes(x = Subgroup,y = subj_corr, colour = Subgroup),data=all_acc_table,dodge.width=1,cex=3.5) +
facet_wrap(task~.) +
scale_color_manual(values=c('black','black'))
# Chunk 59
d <- matrix(nrow=40,ncol=32)
for(i in seq(from=1,to=40,by=1)){d[i,] <- rbind(vsl_accuracy$corr[((i-1)*32+1):(i*32)])}
psych::alpha(d,check.keys = TRUE)$total$std.alpha
vsl_rt <- subset(fam_trial_vsl,select=c(4,3,6))
vsl_rt_w<- spread(vsl_rt, reindex, rt_col)
vsl_rt_w<-select(vsl_rt_w,-PartID)
psych::alpha(vsl_rt_w,check.keys = TRUE)$total$std.alpha
# Chunk 60
d <- matrix(nrow=40,ncol=32)
for(i in seq(from=1,to=40,by=1)){d[i,] <- rbind(tsl_accuracy$corr[((i-1)*32+1):(i*32)])}
psych::alpha(d,check.keys = TRUE)$total$std.alpha
asl_rt <- subset(fam_trial_tsl_usable,select=c(4,3,6))
asl_rt_w<- spread(asl_rt, reindex, rt_col)
asl_rt_w<-select(asl_rt_w,-PartID)
psych::alpha(asl_rt_w,check.keys = TRUE)$total$std.alpha
# Chunk 61
d_all$PA<-rowMeans(d_all[,c('Elision','Blending')])
d_all$WR<-rowMeans(d_all[,c('WID','WA')])
d_all_dys = subset(d_all,Subgroup == "DD")
d_all_typ = subset(d_all,Subgroup == "TYP")
task_data<-d_all%>%ungroup%>%dplyr::select(IQ,WR,Vocabulary,PA,Nonword,DigitsSpan,mean_rp,mean_mt_t,mean_mt_e,aud_acc,vis_acc,aud_slope_scale,vis_slope_scale)
task_data_dys<-d_all_dys%>%ungroup%>%dplyr::select(IQ,WR,Vocabulary,PA,Nonword,DigitsSpan,mean_rp,mean_mt_t,mean_mt_e,aud_acc,vis_acc,aud_slope_scale,vis_slope_scale)
task_data_typ<-d_all_typ%>%ungroup%>%dplyr::select(IQ,WR,Vocabulary,PA,Nonword,DigitsSpan,mean_rp,mean_mt_t,mean_mt_e,aud_acc,vis_acc,aud_slope_scale,vis_slope_scale)
corstars(task_data,method="pearson")#you need to run the function first
# Chunk 62
#corstars(task_data,method="pearson")#you need to run the function first
library(corrr)
x <- correlate(task_data)
x %>%
focus(slope_me,slope_mt, slopeProp_On, vis_slope_scale,aud_slope_scale,aud_fam_rt,vis_fam_rt)%>% fashion()
# Chunk 63
task_only<-d_all%>%ungroup%>%dplyr::select(mean_rp,mean_mt_t,mean_mt_e,aud_acc,vis_acc,aud_slope_scale,vis_slope_scale)
cor<-round(cor(task_only,use="complete.obs"),2)
cor
upper<-cor
upper[upper.tri(cor)]<-""
upper<-as.data.frame(upper)
source('correlation_matrix_function.R')
correlation_matrix(task_only)
save_correlation_matrix(task_only,
filename = "task_correlations.csv",
digits=3,
use='lower')
# Chunk 64
#mean_rp,mean_mt_t,mean_mt_e,aud_acc,vis_acc,aud_slope_scale,vis_slope_scale
BayesFactor::correlationBF(task_data$vis_slope_scale, task_data$aud_slope_scale)
# Chunk 65
#corstars(task_data_dys,method="pearson")#you need to run the function first
x_d <- correlate(task_data_dys)
x_d %>%
focus(mean_rp,mean_mt_t,mean_mt_e,aud_acc,vis_acc,aud_slope_scale,vis_slope_scale)%>% fashion()
plot(task_data_dys$slopeProp_On,task_data_dys$WR)
plot(task_data_typ$slopeProp_On,task_data_typ$WR)
# Chunk 66
ggplot(task_data_dys, aes(x = WA, y = slopeProp_On)) +
stat_smooth (
method = "glm",
formula = y ~ x,
colour = "black",
size = 1) +
geom_point(aes(size = 3)) +
labs(x = "Word Attack ", y = "Rotary Pursuit") +
theme(axis.title = element_text(family = "Trebuchet MS", size = 14))+ theme(panel.background = element_blank(),legend.position = "none")
# Chunk 67
ggplot(task_data_dys, aes(x = RAN_2Set, y = aud_slope_scale)) +
stat_smooth (
method = "glm",
formula = y ~ x,
colour = "black",
size = 1) +
geom_point(aes(size = 3)) +
labs(x = "RAN 2Set ", y = "ASL Slope") +
theme(axis.title = element_text(family = "Trebuchet MS", size = 14))+ theme(panel.background = element_blank(),legend.position = "none")
# Chunk 68
#corstars(task_data_typ,method="pearson")#you need to run the function first
x_t <- correlate(task_data_typ)
x_t %>%
focus(mean_rp,mean_mt_t,mean_mt_e,aud_acc,vis_acc,aud_slope_scale,vis_slope_scale)%>% fashion()
cor.test(d_all$ran_letters_raw_2,d_all$mean_rp)
cor.test(d_all$ran_letters_raw_2,d_all$mean_mt_e)
cor.test(d_all$ran_letters_raw_2,d_all$mean_mt_t)
cor.test(d_all$ran_objects_raw,d_all$mean_mt_t)
cor.test(d_all$ran_objects_raw2,d_all$mean_mt_t)
cor.test(d_all$ran_objects_raw_2,d_all$mean_mt_t)
cor.test(d_all$ran_objects_ss,d_all$mean_mt_t)
cor.test(d_all$RAN_Objects,d_all$mean_mt_t)
cor.test(d_all_dys$RAN_Objects,d_all_dys$mean_mt_t)
cor.test(d_all_dys$RAN_Objects,d_all_dys$mean_mt_e)
cor.test(d_all_dys$RAN_Objects,d_all_dys$mean_rp)
cor.test(d_all_dys$ran_2set_raw,d_all_dys$mean_rp)
cor.test(d_all_dys$ran_objects_raw,d_all_dys$mean_rp)
cor.test(d_all_dys$ran_objects_raw_2,d_all_dys$mean_rp)
plot(d_all_dys$ran_objects_raw_2,d_all_dys$mean_rp)
